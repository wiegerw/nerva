loading dataset cifar10
read slice "../data/cifar-10-batches-bin/data_batch_1.bin"
read slice "../data/cifar-10-batches-bin/data_batch_2.bin"
read slice "../data/cifar-10-batches-bin/data_batch_3.bin"
read slice "../data/cifar-10-batches-bin/data_batch_4.bin"
read slice "../data/cifar-10-batches-bin/data_batch_5.bin"
read slice "../data/cifar-10-batches-bin/test_batch.bin"
normalizing data
number of examples: 50000
number of features: 3072
number of outputs: 10
epochs = 100
batch size = 100
shuffle = true
statistics = true
debug = false
algorithm = minibatch
dataset = cifar10
dataset size = 50000
normalize data = false
learning rate scheduler = multistep_lr(0.01;50,75;0.1)
loss function = softmax-cross-entropy
architecture = RRL
sizes = [3072, 1024, 512, 10]
weights initialization = xxx
optimizer = nesterov(0.9)
dropout = 0
density = 0.2
densities = [0.16875, 0.379687, 1]
seed = 3
precision = 4
threads = 4
number type = float

Sparse(units=1024, density=0.16894753, optimizer=Nesterov(0.90000), activation=ReLU())
Sparse(units=512, density=0.37937355, optimizer=Nesterov(0.90000), activation=ReLU())
Dense(units=10, optimizer=Nesterov(0.90000), activation=NoActivation())

Loading data from file ./cifar3/epoch0.npz
epoch   0 lr: 0.01000000  loss: 2.30428561  train accuracy: 0.10186000  test accuracy: 0.10210000 time: 0.00000000s
epoch   1 lr: 0.01000000  loss: 1.70034498  train accuracy: 0.39562000  test accuracy: 0.42310000 time: 13.11015320s
Loading data from file ./cifar3/epoch1.npz
epoch   2 lr: 0.01000000  loss: 1.55998319  train accuracy: 0.44578000  test accuracy: 0.46550000 time: 12.73588848s
Loading data from file ./cifar3/epoch2.npz
epoch   3 lr: 0.01000000  loss: 1.49833753  train accuracy: 0.46454000  test accuracy: 0.48100000 time: 12.92245007s
Loading data from file ./cifar3/epoch3.npz
epoch   4 lr: 0.01000000  loss: 1.45333396  train accuracy: 0.48900000  test accuracy: 0.49870000 time: 12.71530628s
Loading data from file ./cifar3/epoch4.npz
epoch   5 lr: 0.01000000  loss: 1.42310409  train accuracy: 0.49744000  test accuracy: 0.51350000 time: 12.72247696s
Loading data from file ./cifar3/epoch5.npz
epoch   6 lr: 0.01000000  loss: 1.38183073  train accuracy: 0.51370000  test accuracy: 0.51230000 time: 12.83234024s
Loading data from file ./cifar3/epoch6.npz
epoch   7 lr: 0.01000000  loss: 1.35527818  train accuracy: 0.51978000  test accuracy: 0.52250000 time: 12.80088043s
Loading data from file ./cifar3/epoch7.npz
epoch   8 lr: 0.01000000  loss: 1.33569902  train accuracy: 0.52670000  test accuracy: 0.52130000 time: 12.74860191s
Loading data from file ./cifar3/epoch8.npz
epoch   9 lr: 0.01000000  loss: 1.29994728  train accuracy: 0.54228000  test accuracy: 0.53680000 time: 12.69282532s
Loading data from file ./cifar3/epoch9.npz
epoch  10 lr: 0.01000000  loss: 1.28407268  train accuracy: 0.54996000  test accuracy: 0.53810000 time: 12.71232891s
Loading data from file ./cifar3/epoch10.npz
epoch  11 lr: 0.01000000  loss: 1.25405913  train accuracy: 0.55482000  test accuracy: 0.54880000 time: 12.75851917s
Loading data from file ./cifar3/epoch11.npz
epoch  12 lr: 0.01000000  loss: 1.25422350  train accuracy: 0.55404000  test accuracy: 0.54160000 time: 12.74827385s
Loading data from file ./cifar3/epoch12.npz
epoch  13 lr: 0.01000000  loss: 1.22127117  train accuracy: 0.57048000  test accuracy: 0.55240000 time: 12.93894291s
Loading data from file ./cifar3/epoch13.npz
epoch  14 lr: 0.01000000  loss: 1.20957810  train accuracy: 0.57296000  test accuracy: 0.55560000 time: 12.75188160s
Loading data from file ./cifar3/epoch14.npz
epoch  15 lr: 0.01000000  loss: 1.20208008  train accuracy: 0.57368000  test accuracy: 0.55230000 time: 12.75605679s
Loading data from file ./cifar3/epoch15.npz
epoch  16 lr: 0.01000000  loss: 1.18229800  train accuracy: 0.58272000  test accuracy: 0.56100000 time: 12.72275448s
Loading data from file ./cifar3/epoch16.npz
epoch  17 lr: 0.01000000  loss: 1.17662239  train accuracy: 0.58618000  test accuracy: 0.55680000 time: 12.71626377s
Loading data from file ./cifar3/epoch17.npz
epoch  18 lr: 0.01000000  loss: 1.15169458  train accuracy: 0.59502000  test accuracy: 0.56850000 time: 12.79808712s
Loading data from file ./cifar3/epoch18.npz
epoch  19 lr: 0.01000000  loss: 1.13688548  train accuracy: 0.60186000  test accuracy: 0.57140000 time: 12.68554306s
Loading data from file ./cifar3/epoch19.npz
epoch  20 lr: 0.01000000  loss: 1.13878504  train accuracy: 0.59628000  test accuracy: 0.56670000 time: 12.69386578s
Loading data from file ./cifar3/epoch20.npz
epoch  21 lr: 0.01000000  loss: 1.12642988  train accuracy: 0.60492000  test accuracy: 0.57280000 time: 12.69041538s
Loading data from file ./cifar3/epoch21.npz
epoch  22 lr: 0.01000000  loss: 1.11224696  train accuracy: 0.60878000  test accuracy: 0.57300000 time: 12.70589161s
Loading data from file ./cifar3/epoch22.npz
epoch  23 lr: 0.01000000  loss: 1.09333821  train accuracy: 0.61720000  test accuracy: 0.57680000 time: 12.75826073s
Loading data from file ./cifar3/epoch23.npz
epoch  24 lr: 0.01000000  loss: 1.09456015  train accuracy: 0.61826000  test accuracy: 0.57760000 time: 12.64413548s
Loading data from file ./cifar3/epoch24.npz
epoch  25 lr: 0.01000000  loss: 1.07891761  train accuracy: 0.62350000  test accuracy: 0.58690000 time: 12.87040138s
Loading data from file ./cifar3/epoch25.npz
epoch  26 lr: 0.01000000  loss: 1.05967753  train accuracy: 0.63016000  test accuracy: 0.58410000 time: 12.69575024s
Loading data from file ./cifar3/epoch26.npz
epoch  27 lr: 0.01000000  loss: 1.05265981  train accuracy: 0.63190000  test accuracy: 0.58670000 time: 12.67357635s
Loading data from file ./cifar3/epoch27.npz
epoch  28 lr: 0.01000000  loss: 1.04898170  train accuracy: 0.63374000  test accuracy: 0.58650000 time: 12.67112732s
Loading data from file ./cifar3/epoch28.npz
epoch  29 lr: 0.01000000  loss: 1.03474208  train accuracy: 0.63780000  test accuracy: 0.59370000 time: 12.67170429s
Loading data from file ./cifar3/epoch29.npz
epoch  30 lr: 0.01000000  loss: 1.03354645  train accuracy: 0.63700000  test accuracy: 0.59200000 time: 12.97709846s
Loading data from file ./cifar3/epoch30.npz
epoch  31 lr: 0.01000000  loss: 1.03559771  train accuracy: 0.63750000  test accuracy: 0.59190000 time: 12.77361488s
Loading data from file ./cifar3/epoch31.npz
epoch  32 lr: 0.01000000  loss: 1.02851421  train accuracy: 0.63902000  test accuracy: 0.58780000 time: 12.86450958s
Loading data from file ./cifar3/epoch32.npz
epoch  33 lr: 0.01000000  loss: 1.01455655  train accuracy: 0.64900000  test accuracy: 0.59990000 time: 12.68802547s
Loading data from file ./cifar3/epoch33.npz
epoch  34 lr: 0.01000000  loss: 1.01799335  train accuracy: 0.64506000  test accuracy: 0.59620000 time: 12.68214417s
Loading data from file ./cifar3/epoch34.npz
epoch  35 lr: 0.01000000  loss: 1.00796944  train accuracy: 0.64598000  test accuracy: 0.59170000 time: 12.71417332s
Loading data from file ./cifar3/epoch35.npz
epoch  36 lr: 0.01000000  loss: 0.99219196  train accuracy: 0.65654000  test accuracy: 0.59520000 time: 12.72538280s
Loading data from file ./cifar3/epoch36.npz
epoch  37 lr: 0.01000000  loss: 0.99839979  train accuracy: 0.65426000  test accuracy: 0.59070000 time: 12.92582321s
Loading data from file ./cifar3/epoch37.npz
epoch  38 lr: 0.01000000  loss: 0.98051073  train accuracy: 0.65840000  test accuracy: 0.59520000 time: 12.70357704s
Loading data from file ./cifar3/epoch38.npz
epoch  39 lr: 0.01000000  loss: 0.97216842  train accuracy: 0.66320000  test accuracy: 0.59790000 time: 12.68923664s
Loading data from file ./cifar3/epoch39.npz
epoch  40 lr: 0.01000000  loss: 0.96740583  train accuracy: 0.65970000  test accuracy: 0.59680000 time: 12.86520290s
Loading data from file ./cifar3/epoch40.npz
epoch  41 lr: 0.01000000  loss: 0.94695840  train accuracy: 0.67112000  test accuracy: 0.60620000 time: 12.66315460s
Loading data from file ./cifar3/epoch41.npz
epoch  42 lr: 0.01000000  loss: 0.95341866  train accuracy: 0.66474000  test accuracy: 0.60300000 time: 12.72556686s
Loading data from file ./cifar3/epoch42.npz
epoch  43 lr: 0.01000000  loss: 0.95569221  train accuracy: 0.66784000  test accuracy: 0.60170000 time: 12.69577026s
Loading data from file ./cifar3/epoch43.npz
epoch  44 lr: 0.01000000  loss: 0.94692179  train accuracy: 0.66886000  test accuracy: 0.60600000 time: 12.75875473s
Loading data from file ./cifar3/epoch44.npz
epoch  45 lr: 0.01000000  loss: 0.94862979  train accuracy: 0.66892000  test accuracy: 0.60120000 time: 12.67419052s
Loading data from file ./cifar3/epoch45.npz
epoch  46 lr: 0.01000000  loss: 0.93702450  train accuracy: 0.67556000  test accuracy: 0.60820000 time: 12.75897408s
Loading data from file ./cifar3/epoch46.npz
epoch  47 lr: 0.01000000  loss: 0.92694665  train accuracy: 0.67598000  test accuracy: 0.60820000 time: 12.75068760s
Loading data from file ./cifar3/epoch47.npz
epoch  48 lr: 0.01000000  loss: 0.92345670  train accuracy: 0.67930000  test accuracy: 0.60840000 time: 12.69045162s
Loading data from file ./cifar3/epoch48.npz
epoch  49 lr: 0.01000000  loss: 0.91961822  train accuracy: 0.67934000  test accuracy: 0.60340000 time: 12.89492512s
Loading data from file ./cifar3/epoch49.npz
epoch  50 lr: 0.01000000  loss: 0.92389215  train accuracy: 0.67786000  test accuracy: 0.60350000 time: 12.72250748s
Loading data from file ./cifar3/epoch50.npz
epoch  51 lr: 0.00100000  loss: 0.96583126  train accuracy: 0.66208000  test accuracy: 0.62930000 time: 12.67971897s
Loading data from file ./cifar3/epoch51.npz
epoch  52 lr: 0.00100000  loss: 0.94865004  train accuracy: 0.66870000  test accuracy: 0.63360000 time: 12.79217434s
Loading data from file ./cifar3/epoch52.npz
epoch  53 lr: 0.00100000  loss: 0.93760746  train accuracy: 0.67164000  test accuracy: 0.63550000 time: 12.66564846s
Loading data from file ./cifar3/epoch53.npz
epoch  54 lr: 0.00100000  loss: 0.93048218  train accuracy: 0.67382000  test accuracy: 0.63900000 time: 12.72519207s
Loading data from file ./cifar3/epoch54.npz
epoch  55 lr: 0.00100000  loss: 0.92825322  train accuracy: 0.67420000  test accuracy: 0.63630000 time: 12.64302158s
Loading data from file ./cifar3/epoch55.npz
epoch  56 lr: 0.00100000  loss: 0.93077160  train accuracy: 0.67352000  test accuracy: 0.64090000 time: 12.70760727s
Loading data from file ./cifar3/epoch56.npz
epoch  57 lr: 0.00100000  loss: 0.92114653  train accuracy: 0.67676000  test accuracy: 0.63980000 time: 12.66691399s
Loading data from file ./cifar3/epoch57.npz
epoch  58 lr: 0.00100000  loss: 0.91667452  train accuracy: 0.67972000  test accuracy: 0.64080000 time: 12.64413261s
Loading data from file ./cifar3/epoch58.npz
epoch  59 lr: 0.00100000  loss: 0.91556298  train accuracy: 0.67748000  test accuracy: 0.64110000 time: 12.66232300s
Loading data from file ./cifar3/epoch59.npz
epoch  60 lr: 0.00100000  loss: 0.91108602  train accuracy: 0.68178000  test accuracy: 0.63910000 time: 12.71065331s
Loading data from file ./cifar3/epoch60.npz
epoch  61 lr: 0.00100000  loss: 0.90775942  train accuracy: 0.68082000  test accuracy: 0.64230000 time: 12.76276779s
Loading data from file ./cifar3/epoch61.npz
epoch  62 lr: 0.00100000  loss: 0.90293974  train accuracy: 0.68272000  test accuracy: 0.64030000 time: 13.47117424s
Loading data from file ./cifar3/epoch62.npz
epoch  63 lr: 0.00100000  loss: 0.90669663  train accuracy: 0.68388000  test accuracy: 0.64020000 time: 12.69278431s
Loading data from file ./cifar3/epoch63.npz
epoch  64 lr: 0.00100000  loss: 0.90365349  train accuracy: 0.68442000  test accuracy: 0.64020000 time: 12.76484394s
Loading data from file ./cifar3/epoch64.npz
epoch  65 lr: 0.00100000  loss: 0.90488871  train accuracy: 0.68196000  test accuracy: 0.64080000 time: 12.72797871s
Loading data from file ./cifar3/epoch65.npz
epoch  66 lr: 0.00100000  loss: 0.89825336  train accuracy: 0.68612000  test accuracy: 0.64230000 time: 12.65937805s
Loading data from file ./cifar3/epoch66.npz
epoch  67 lr: 0.00100000  loss: 0.89571451  train accuracy: 0.68408000  test accuracy: 0.63880000 time: 12.73151779s
Loading data from file ./cifar3/epoch67.npz
epoch  68 lr: 0.00100000  loss: 0.89034423  train accuracy: 0.68962000  test accuracy: 0.64190000 time: 12.66139317s
Loading data from file ./cifar3/epoch68.npz
epoch  69 lr: 0.00100000  loss: 0.89307709  train accuracy: 0.68694000  test accuracy: 0.64110000 time: 12.66204548s
Loading data from file ./cifar3/epoch69.npz
epoch  70 lr: 0.00100000  loss: 0.88735874  train accuracy: 0.69010000  test accuracy: 0.64320000 time: 13.13172626s
Loading data from file ./cifar3/epoch70.npz
epoch  71 lr: 0.00100000  loss: 0.88899834  train accuracy: 0.68920000  test accuracy: 0.64270000 time: 14.28939152s
Loading data from file ./cifar3/epoch71.npz
epoch  72 lr: 0.00100000  loss: 0.88419145  train accuracy: 0.69062000  test accuracy: 0.64550000 time: 13.32475758s
Loading data from file ./cifar3/epoch72.npz
epoch  73 lr: 0.00100000  loss: 0.88873447  train accuracy: 0.68968000  test accuracy: 0.64520000 time: 13.07071781s
Loading data from file ./cifar3/epoch73.npz
epoch  74 lr: 0.00100000  loss: 0.87957032  train accuracy: 0.69146000  test accuracy: 0.64550000 time: 12.73756313s
Loading data from file ./cifar3/epoch74.npz
epoch  75 lr: 0.00100000  loss: 0.88425967  train accuracy: 0.69128000  test accuracy: 0.64610000 time: 12.68863583s
Loading data from file ./cifar3/epoch75.npz
epoch  76 lr: 0.00010000  loss: 0.91093140  train accuracy: 0.68150000  test accuracy: 0.64690000 time: 12.78229618s
Loading data from file ./cifar3/epoch76.npz
epoch  77 lr: 0.00010000  loss: 0.91368628  train accuracy: 0.67948000  test accuracy: 0.64710000 time: 12.66555595s
Loading data from file ./cifar3/epoch77.npz
epoch  78 lr: 0.00010000  loss: 0.90701682  train accuracy: 0.68114000  test accuracy: 0.64780000 time: 12.66078472s
Loading data from file ./cifar3/epoch78.npz
epoch  79 lr: 0.00010000  loss: 0.91178472  train accuracy: 0.67886000  test accuracy: 0.64560000 time: 12.66438103s
Loading data from file ./cifar3/epoch79.npz
epoch  80 lr: 0.00010000  loss: 0.90556390  train accuracy: 0.68014000  test accuracy: 0.64590000 time: 12.67403603s
Loading data from file ./cifar3/epoch80.npz
epoch  81 lr: 0.00010000  loss: 0.91009512  train accuracy: 0.68278000  test accuracy: 0.64620000 time: 14.80397224s
Loading data from file ./cifar3/epoch81.npz
epoch  82 lr: 0.00010000  loss: 0.91239109  train accuracy: 0.68060000  test accuracy: 0.64660000 time: 12.73621273s
Loading data from file ./cifar3/epoch82.npz
epoch  83 lr: 0.00010000  loss: 0.91225677  train accuracy: 0.67934000  test accuracy: 0.64410000 time: 14.01719952s
Loading data from file ./cifar3/epoch83.npz
epoch  84 lr: 0.00010000  loss: 0.91009668  train accuracy: 0.67988000  test accuracy: 0.64600000 time: 12.80679417s
Loading data from file ./cifar3/epoch84.npz
epoch  85 lr: 0.00010000  loss: 0.91032717  train accuracy: 0.68052000  test accuracy: 0.64630000 time: 13.04811954s
Loading data from file ./cifar3/epoch85.npz
epoch  86 lr: 0.00010000  loss: 0.90690754  train accuracy: 0.68142000  test accuracy: 0.64650000 time: 12.70801926s
Loading data from file ./cifar3/epoch86.npz
epoch  87 lr: 0.00010000  loss: 0.90630318  train accuracy: 0.68124000  test accuracy: 0.64650000 time: 12.75709057s
Loading data from file ./cifar3/epoch87.npz
epoch  88 lr: 0.00010000  loss: 0.90471306  train accuracy: 0.68262000  test accuracy: 0.64640000 time: 13.13659477s
Loading data from file ./cifar3/epoch88.npz
epoch  89 lr: 0.00010000  loss: 0.90554685  train accuracy: 0.68048000  test accuracy: 0.64660000 time: 12.93379784s
Loading data from file ./cifar3/epoch89.npz
epoch  90 lr: 0.00010000  loss: 0.90781815  train accuracy: 0.68222000  test accuracy: 0.64700000 time: 13.83531475s
Loading data from file ./cifar3/epoch90.npz
epoch  91 lr: 0.00010000  loss: 0.90180876  train accuracy: 0.68252000  test accuracy: 0.64590000 time: 12.73543167s
Loading data from file ./cifar3/epoch91.npz
epoch  92 lr: 0.00010000  loss: 0.90733320  train accuracy: 0.68288000  test accuracy: 0.64690000 time: 12.69961929s
Loading data from file ./cifar3/epoch92.npz
epoch  93 lr: 0.00010000  loss: 0.90732995  train accuracy: 0.68394000  test accuracy: 0.64690000 time: 12.70527840s
Loading data from file ./cifar3/epoch93.npz
epoch  94 lr: 0.00010000  loss: 0.90850968  train accuracy: 0.68150000  test accuracy: 0.64780000 time: 12.68453026s
Loading data from file ./cifar3/epoch94.npz
epoch  95 lr: 0.00010000  loss: 0.91207867  train accuracy: 0.68098000  test accuracy: 0.64740000 time: 12.72978783s
Loading data from file ./cifar3/epoch95.npz
epoch  96 lr: 0.00010000  loss: 0.90249952  train accuracy: 0.68228000  test accuracy: 0.64880000 time: 12.65210629s
Loading data from file ./cifar3/epoch96.npz
epoch  97 lr: 0.00010000  loss: 0.90714620  train accuracy: 0.67998000  test accuracy: 0.64700000 time: 12.97925949s
Loading data from file ./cifar3/epoch97.npz
epoch  98 lr: 0.00010000  loss: 0.90163339  train accuracy: 0.68262000  test accuracy: 0.64690000 time: 12.68582153s
Loading data from file ./cifar3/epoch98.npz
epoch  99 lr: 0.00010000  loss: 0.90448955  train accuracy: 0.68442000  test accuracy: 0.64870000 time: 12.68112755s
Loading data from file ./cifar3/epoch99.npz
epoch 100 lr: 0.00010000  loss: 0.90428689  train accuracy: 0.68076000  test accuracy: 0.64770000 time: 12.68262291s
Accuracy of the network on the 10000 test examples: 64.77%
Total training time for the 100 epochs: 1282.62829102s
