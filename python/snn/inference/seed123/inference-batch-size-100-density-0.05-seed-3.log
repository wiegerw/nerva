=== Command line arguments ===
Namespace(debug=False, batch_size=100, seed=None, precision=4, edgeitems=3, density=0.05, sizes='3072,1024,512,10', epochs=100, lr=0.1, momentum=0.9, gamma=0.1, nesterov=False, datadir='./data', augmented=False, preprocessed=None, copy=False, nerva=False, torch=False, inference=True, save_model_npy=None, scheduler='multistep', export_weights_npz=None, import_weights_npz=None, custom_masking=True)
Files already downloaded and verified
initialize by ER
Overall sparsity 0.05
Total Model parameters: 3675136
Total parameters under sparsity level of 0.05: 0.049992435654081915
initialize by ER
Overall sparsity 0.05
Total Model parameters: 7350272
Total parameters under sparsity level of 0.05: 0.004129370994706046
Use MLP1 variant with custom masking
Setting masks with densities [0.041299715909090914, 0.09292436079545456, 1.0]
batch 0 took 0.04312777 seconds
batch 1 took 0.03135800 seconds
batch 2 took 0.01314553 seconds
batch 3 took 0.00879476 seconds
batch 4 took 0.01247215 seconds
batch 5 took 0.00691829 seconds
batch 6 took 0.00655857 seconds
batch 7 took 0.01008068 seconds
batch 8 took 0.01031587 seconds
batch 9 took 0.00691298 seconds
batch 10 took 0.00805667 seconds
Average PyTorch inference time for density=0.05 batch_size=100: 11.4613ms
batch 0 took 0.02984751 seconds
batch 1 took 0.00275310 seconds
batch 2 took 0.00275635 seconds
batch 3 took 0.00298223 seconds
batch 4 took 0.00410265 seconds
batch 5 took 0.00350970 seconds
batch 6 took 0.00686893 seconds
batch 7 took 0.00385787 seconds
batch 8 took 0.00864350 seconds
batch 9 took 0.00360533 seconds
batch 10 took 0.00408194 seconds
Average Nerva inference time for density=0.05 batch_size=100: 4.3162ms
