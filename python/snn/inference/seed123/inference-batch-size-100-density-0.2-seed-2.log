=== Command line arguments ===
Namespace(debug=False, batch_size=100, seed=None, precision=4, edgeitems=3, density=0.2, sizes='3072,1024,512,10', epochs=100, lr=0.1, momentum=0.9, gamma=0.1, nesterov=False, datadir='./data', augmented=False, preprocessed=None, copy=False, nerva=False, torch=False, inference=True, save_model_npy=None, scheduler='multistep', export_weights_npz=None, import_weights_npz=None, custom_masking=True)
Files already downloaded and verified
initialize by ER
Overall sparsity 0.20000000000000004
Total Model parameters: 3675136
Total parameters under sparsity level of 0.2: 0.19992647891125662
initialize by ER
Overall sparsity 0.20000000000000004
Total Model parameters: 7350272
Total parameters under sparsity level of 0.2: 0.04637052887294511
Use MLP1 variant with custom masking
Setting masks with densities [0.16875, 0.37968750000000007, 1.0]
batch 0 took 0.03617956 seconds
batch 1 took 0.00682677 seconds
batch 2 took 0.00686192 seconds
batch 3 took 0.00530704 seconds
batch 4 took 0.00572381 seconds
batch 5 took 0.00576432 seconds
batch 6 took 0.02301343 seconds
batch 7 took 0.00689872 seconds
batch 8 took 0.00539903 seconds
batch 9 took 0.00572900 seconds
batch 10 took 0.01334639 seconds
Average PyTorch inference time for density=0.2 batch_size=100: 8.4870ms
batch 0 took 0.04628008 seconds
batch 1 took 0.01049651 seconds
batch 2 took 0.01307792 seconds
batch 3 took 0.01253412 seconds
batch 4 took 0.01198939 seconds
batch 5 took 0.01124431 seconds
batch 6 took 0.01204403 seconds
batch 7 took 0.01352774 seconds
batch 8 took 0.01184070 seconds
batch 9 took 0.01242188 seconds
batch 10 took 0.01138482 seconds
Average Nerva inference time for density=0.2 batch_size=100: 12.0561ms
