=== Command line arguments ===
Namespace(debug=False, batch_size=1, seed=None, precision=4, edgeitems=3, density=0.005, sizes='3072,1024,512,10', epochs=100, lr=0.1, momentum=0.9, gamma=0.1, nesterov=False, datadir='./data', augmented=False, preprocessed=None, copy=False, nerva=False, torch=False, inference=True, save_model_npy=None, scheduler='multistep', export_weights_npz=None, import_weights_npz=None, custom_masking=True)
Files already downloaded and verified
initialize by ER
Overall sparsity 0.005
Total Model parameters: 3675136
Total parameters under sparsity level of 0.005: 0.004948660403315687
initialize by ER
Overall sparsity 0.005
Total Model parameters: 7350272
Total parameters under sparsity level of 0.005: 0.00015536839997213708
Use MLP1 variant with custom masking
Setting masks with densities [0.0038879861336799906, 0.008747968800779979, 0.3044293142671433]
batch 0 took 0.00148129 seconds
batch 1 took 0.00093722 seconds
batch 2 took 0.00341659 seconds
batch 3 took 0.00082078 seconds
batch 4 took 0.00080457 seconds
batch 5 took 0.00114612 seconds
batch 6 took 0.00083980 seconds
batch 7 took 0.00090894 seconds
batch 8 took 0.00104380 seconds
batch 9 took 0.00102224 seconds
batch 10 took 0.00102237 seconds
Average PyTorch inference time for density=0.005 batch_size=1: 1.1962ms
batch 0 took 0.02296079 seconds
batch 1 took 0.00006708 seconds
batch 2 took 0.00005272 seconds
batch 3 took 0.00005238 seconds
batch 4 took 0.00007468 seconds
batch 5 took 0.00004049 seconds
batch 6 took 0.00004816 seconds
batch 7 took 0.00005640 seconds
batch 8 took 0.00005079 seconds
batch 9 took 0.00003902 seconds
batch 10 took 0.00008341 seconds
Average Nerva inference time for density=0.005 batch_size=1: 0.0565ms
