=== Command line arguments ===
Namespace(debug=False, batch_size=100, seed=None, precision=4, edgeitems=3, density=0.5, sizes='3072,1024,512,10', epochs=100, lr=0.1, momentum=0.9, gamma=0.1, nesterov=False, datadir='./data', augmented=False, preprocessed=None, copy=False, nerva=False, torch=False, inference=True, save_model_npy=None, scheduler='multistep', export_weights_npz=None, import_weights_npz=None, custom_masking=True)
Files already downloaded and verified
initialize by ER
Overall sparsity 0.5
Total Model parameters: 3675136
Total parameters under sparsity level of 0.5: 0.4995921239377264
initialize by ER
Overall sparsity 0.5
Total Model parameters: 7350272
Total parameters under sparsity level of 0.5: 0.2845891961549178
Use MLP1 variant with custom masking
Setting masks with densities [0.4236505681818182, 0.9532137784090909, 1.0]
batch 0 took 0.02802302 seconds
batch 1 took 0.00558643 seconds
batch 2 took 0.00828554 seconds
batch 3 took 0.00584176 seconds
batch 4 took 0.00573444 seconds
batch 5 took 0.00600681 seconds
batch 6 took 0.01505185 seconds
batch 7 took 0.01024847 seconds
batch 8 took 0.00803647 seconds
batch 9 took 0.00622218 seconds
batch 10 took 0.00649318 seconds
Average PyTorch inference time for density=0.5 batch_size=100: 7.7507ms
batch 0 took 0.06235236 seconds
batch 1 took 0.02384822 seconds
batch 2 took 0.02767777 seconds
batch 3 took 0.02630036 seconds
batch 4 took 0.02340779 seconds
batch 5 took 0.02489532 seconds
batch 6 took 0.02596178 seconds
batch 7 took 0.02646690 seconds
batch 8 took 0.02490137 seconds
batch 9 took 0.02669134 seconds
batch 10 took 0.02436400 seconds
Average Nerva inference time for density=0.5 batch_size=100: 25.4515ms
