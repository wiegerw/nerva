=== Command line arguments ===
Namespace(debug=False, batch_size=100, seed=None, precision=4, edgeitems=3, density=0.001, sizes='3072,1024,512,10', epochs=100, lr=0.1, momentum=0.9, gamma=0.1, nesterov=False, datadir='./data', augmented=False, preprocessed=None, copy=False, nerva=False, torch=False, inference=True, save_model_npy=None, scheduler='multistep', export_weights_npz=None, import_weights_npz=None, custom_masking=True)
Files already downloaded and verified
initialize by ER
Overall sparsity 0.001
Total Model parameters: 3675136
Total parameters under sparsity level of 0.001: 0.0010222750940373363
initialize by ER
Overall sparsity 0.001
Total Model parameters: 7350272
Total parameters under sparsity level of 0.001: 7.890864446921148e-06
Use MLP1 variant with custom masking
Setting masks with densities [0.0007775972267359982, 0.0017495937601559961, 0.06088586285342867]
batch 0 took 0.01984723 seconds
batch 1 took 0.01460881 seconds
batch 2 took 0.00740217 seconds
batch 3 took 0.01759608 seconds
batch 4 took 0.00766808 seconds
batch 5 took 0.00604442 seconds
batch 6 took 0.01810291 seconds
batch 7 took 0.00676079 seconds
batch 8 took 0.00589734 seconds
batch 9 took 0.00661558 seconds
batch 10 took 0.00708276 seconds
Average PyTorch inference time for density=0.001 batch_size=100: 9.7779ms
batch 0 took 0.05140326 seconds
batch 1 took 0.01272414 seconds
batch 2 took 0.00285481 seconds
batch 3 took 0.00308399 seconds
batch 4 took 0.00086831 seconds
batch 5 took 0.00283558 seconds
batch 6 took 0.00109756 seconds
batch 7 took 0.00183762 seconds
batch 8 took 0.00111949 seconds
batch 9 took 0.00087043 seconds
batch 10 took 0.00969604 seconds
Average Nerva inference time for density=0.001 batch_size=100: 3.6988ms
