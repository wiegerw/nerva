loading dataset cifar10
read slice "../data/cifar-10-batches-bin/data_batch_1.bin"
read slice "../data/cifar-10-batches-bin/data_batch_2.bin"
read slice "../data/cifar-10-batches-bin/data_batch_3.bin"
read slice "../data/cifar-10-batches-bin/data_batch_4.bin"
read slice "../data/cifar-10-batches-bin/data_batch_5.bin"
read slice "../data/cifar-10-batches-bin/test_batch.bin"
normalizing data
number of examples: 50000
number of features: 3072
number of outputs: 10
epochs = 100
batch size = 100
shuffle = true
statistics = true
debug = false
algorithm = minibatch
dataset = cifar10
dataset size = 50000
normalize data = false
learning rate scheduler = multistep_lr(0.01;50,75;0.1)
loss function = softmax-cross-entropy
architecture = RRL
sizes = [3072, 1024, 512, 10]
weights initialization = xxx
optimizer = nesterov(0.9)
dropout = 0
density = 1
densities = [1, 1, 1]
seed = 2
precision = 4
threads = 4
number type = float

Dense(units=1024, optimizer=Nesterov(0.90000), activation=ReLU())
Dense(units=512, optimizer=Nesterov(0.90000), activation=ReLU())
Dense(units=10, optimizer=Nesterov(0.90000), activation=NoActivation())

Loading data from file ./cifar2/epoch0.npz
epoch   0 lr: 0.01000000  loss: 2.31974340  train accuracy: 0.09462000  test accuracy: 0.09470000 time: 0.00000000s
epoch   1 lr: 0.01000000  loss: 1.56586045  train accuracy: 0.44558000  test accuracy: 0.45310000 time: 8.22569275s
Loading data from file ./cifar2/epoch1.npz
epoch   2 lr: 0.01000000  loss: 1.47028261  train accuracy: 0.47988000  test accuracy: 0.48290000 time: 8.22935104s
Loading data from file ./cifar2/epoch2.npz
epoch   3 lr: 0.01000000  loss: 1.40033400  train accuracy: 0.50750000  test accuracy: 0.49820000 time: 8.19231129s
Loading data from file ./cifar2/epoch3.npz
epoch   4 lr: 0.01000000  loss: 1.36854466  train accuracy: 0.51866000  test accuracy: 0.51230000 time: 8.18858433s
Loading data from file ./cifar2/epoch4.npz
epoch   5 lr: 0.01000000  loss: 1.34013405  train accuracy: 0.52610000  test accuracy: 0.51720000 time: 8.19456482s
Loading data from file ./cifar2/epoch5.npz
epoch   6 lr: 0.01000000  loss: 1.30691161  train accuracy: 0.53780000  test accuracy: 0.51930000 time: 8.18315220s
Loading data from file ./cifar2/epoch6.npz
epoch   7 lr: 0.01000000  loss: 1.28190059  train accuracy: 0.54766000  test accuracy: 0.52640000 time: 8.18832874s
Loading data from file ./cifar2/epoch7.npz
epoch   8 lr: 0.01000000  loss: 1.25463499  train accuracy: 0.55608000  test accuracy: 0.54170000 time: 8.17458725s
Loading data from file ./cifar2/epoch8.npz
epoch   9 lr: 0.01000000  loss: 1.22897803  train accuracy: 0.56258000  test accuracy: 0.54370000 time: 8.18867397s
Loading data from file ./cifar2/epoch9.npz
epoch  10 lr: 0.01000000  loss: 1.23448334  train accuracy: 0.56126000  test accuracy: 0.54220000 time: 8.18172932s
Loading data from file ./cifar2/epoch10.npz
epoch  11 lr: 0.01000000  loss: 1.21044509  train accuracy: 0.56848000  test accuracy: 0.54130000 time: 8.17152309s
Loading data from file ./cifar2/epoch11.npz
epoch  12 lr: 0.01000000  loss: 1.18859473  train accuracy: 0.58138000  test accuracy: 0.55290000 time: 8.18279648s
Loading data from file ./cifar2/epoch12.npz
epoch  13 lr: 0.01000000  loss: 1.17727428  train accuracy: 0.58294000  test accuracy: 0.54910000 time: 8.17895031s
Loading data from file ./cifar2/epoch13.npz
epoch  14 lr: 0.01000000  loss: 1.16019685  train accuracy: 0.59098000  test accuracy: 0.56040000 time: 8.19867229s
Loading data from file ./cifar2/epoch14.npz
epoch  15 lr: 0.01000000  loss: 1.16281908  train accuracy: 0.58560000  test accuracy: 0.55640000 time: 8.17289352s
Loading data from file ./cifar2/epoch15.npz
epoch  16 lr: 0.01000000  loss: 1.15243395  train accuracy: 0.58928000  test accuracy: 0.55640000 time: 8.17968941s
Loading data from file ./cifar2/epoch16.npz
epoch  17 lr: 0.01000000  loss: 1.13900634  train accuracy: 0.59534000  test accuracy: 0.55750000 time: 8.17299461s
Loading data from file ./cifar2/epoch17.npz
epoch  18 lr: 0.01000000  loss: 1.12145146  train accuracy: 0.61136000  test accuracy: 0.56470000 time: 8.16928482s
Loading data from file ./cifar2/epoch18.npz
epoch  19 lr: 0.01000000  loss: 1.10470619  train accuracy: 0.60644000  test accuracy: 0.55920000 time: 8.16286945s
Loading data from file ./cifar2/epoch19.npz
epoch  20 lr: 0.01000000  loss: 1.09095954  train accuracy: 0.61500000  test accuracy: 0.55960000 time: 8.20950413s
Loading data from file ./cifar2/epoch20.npz
epoch  21 lr: 0.01000000  loss: 1.07670807  train accuracy: 0.62302000  test accuracy: 0.56830000 time: 8.18272591s
Loading data from file ./cifar2/epoch21.npz
epoch  22 lr: 0.01000000  loss: 1.07992108  train accuracy: 0.61666000  test accuracy: 0.56720000 time: 8.17610836s
Loading data from file ./cifar2/epoch22.npz
epoch  23 lr: 0.01000000  loss: 1.05744130  train accuracy: 0.62490000  test accuracy: 0.57860000 time: 8.22650814s
Loading data from file ./cifar2/epoch23.npz
epoch  24 lr: 0.01000000  loss: 1.05495907  train accuracy: 0.62880000  test accuracy: 0.57480000 time: 8.21807289s
Loading data from file ./cifar2/epoch24.npz
epoch  25 lr: 0.01000000  loss: 1.03076202  train accuracy: 0.63242000  test accuracy: 0.58290000 time: 8.18440628s
Loading data from file ./cifar2/epoch25.npz
epoch  26 lr: 0.01000000  loss: 1.04055280  train accuracy: 0.62956000  test accuracy: 0.57060000 time: 8.18041229s
Loading data from file ./cifar2/epoch26.npz
epoch  27 lr: 0.01000000  loss: 1.01673012  train accuracy: 0.64342000  test accuracy: 0.58420000 time: 8.17298126s
Loading data from file ./cifar2/epoch27.npz
epoch  28 lr: 0.01000000  loss: 1.01515350  train accuracy: 0.63934000  test accuracy: 0.57880000 time: 8.17620373s
Loading data from file ./cifar2/epoch28.npz
epoch  29 lr: 0.01000000  loss: 1.02052118  train accuracy: 0.64468000  test accuracy: 0.57610000 time: 8.21196270s
Loading data from file ./cifar2/epoch29.npz
epoch  30 lr: 0.01000000  loss: 0.99847649  train accuracy: 0.64866000  test accuracy: 0.58510000 time: 8.16978455s
Loading data from file ./cifar2/epoch30.npz
epoch  31 lr: 0.01000000  loss: 1.00083428  train accuracy: 0.64540000  test accuracy: 0.58030000 time: 8.25381947s
Loading data from file ./cifar2/epoch31.npz
epoch  32 lr: 0.01000000  loss: 0.99129226  train accuracy: 0.64750000  test accuracy: 0.57810000 time: 8.17405415s
Loading data from file ./cifar2/epoch32.npz
epoch  33 lr: 0.01000000  loss: 0.98596875  train accuracy: 0.65204000  test accuracy: 0.58690000 time: 8.16711426s
Loading data from file ./cifar2/epoch33.npz
epoch  34 lr: 0.01000000  loss: 0.96976571  train accuracy: 0.65632000  test accuracy: 0.58380000 time: 8.17358875s
Loading data from file ./cifar2/epoch34.npz
epoch  35 lr: 0.01000000  loss: 0.95604364  train accuracy: 0.66170000  test accuracy: 0.58890000 time: 8.21075630s
Loading data from file ./cifar2/epoch35.npz
epoch  36 lr: 0.01000000  loss: 0.97020963  train accuracy: 0.65974000  test accuracy: 0.58420000 time: 8.18152428s
Loading data from file ./cifar2/epoch36.npz
epoch  37 lr: 0.01000000  loss: 0.95764527  train accuracy: 0.66056000  test accuracy: 0.58990000 time: 8.16937637s
Loading data from file ./cifar2/epoch37.npz
epoch  38 lr: 0.01000000  loss: 0.95788629  train accuracy: 0.66406000  test accuracy: 0.58930000 time: 8.18374157s
Loading data from file ./cifar2/epoch38.npz
epoch  39 lr: 0.01000000  loss: 0.93277690  train accuracy: 0.67100000  test accuracy: 0.58840000 time: 8.17779446s
Loading data from file ./cifar2/epoch39.npz
epoch  40 lr: 0.01000000  loss: 0.95168088  train accuracy: 0.66410000  test accuracy: 0.59160000 time: 8.17346191s
Loading data from file ./cifar2/epoch40.npz
epoch  41 lr: 0.01000000  loss: 0.90970391  train accuracy: 0.68062000  test accuracy: 0.59660000 time: 8.16291237s
Loading data from file ./cifar2/epoch41.npz
epoch  42 lr: 0.01000000  loss: 0.91946061  train accuracy: 0.67958000  test accuracy: 0.59490000 time: 8.18905640s
Loading data from file ./cifar2/epoch42.npz
epoch  43 lr: 0.01000000  loss: 0.92181538  train accuracy: 0.67492000  test accuracy: 0.59080000 time: 8.20269775s
Loading data from file ./cifar2/epoch43.npz
epoch  44 lr: 0.01000000  loss: 0.90966814  train accuracy: 0.68166000  test accuracy: 0.59390000 time: 8.16928673s
Loading data from file ./cifar2/epoch44.npz
epoch  45 lr: 0.01000000  loss: 0.91615856  train accuracy: 0.67502000  test accuracy: 0.59180000 time: 8.19055080s
Loading data from file ./cifar2/epoch45.npz
epoch  46 lr: 0.01000000  loss: 0.89480642  train accuracy: 0.68442000  test accuracy: 0.60220000 time: 8.16530991s
Loading data from file ./cifar2/epoch46.npz
epoch  47 lr: 0.01000000  loss: 0.88901796  train accuracy: 0.68810000  test accuracy: 0.58780000 time: 8.16639423s
Loading data from file ./cifar2/epoch47.npz
epoch  48 lr: 0.01000000  loss: 0.89073454  train accuracy: 0.68552000  test accuracy: 0.59200000 time: 8.16633797s
Loading data from file ./cifar2/epoch48.npz
epoch  49 lr: 0.01000000  loss: 0.89169753  train accuracy: 0.68498000  test accuracy: 0.59290000 time: 8.16688919s
Loading data from file ./cifar2/epoch49.npz
epoch  50 lr: 0.01000000  loss: 0.88884414  train accuracy: 0.68580000  test accuracy: 0.59220000 time: 8.16111755s
Loading data from file ./cifar2/epoch50.npz
epoch  51 lr: 0.00100000  loss: 0.91326925  train accuracy: 0.67788000  test accuracy: 0.62400000 time: 8.17411137s
Loading data from file ./cifar2/epoch51.npz
epoch  52 lr: 0.00100000  loss: 0.88506679  train accuracy: 0.68940000  test accuracy: 0.62830000 time: 8.16354656s
Loading data from file ./cifar2/epoch52.npz
epoch  53 lr: 0.00100000  loss: 0.87069726  train accuracy: 0.69204000  test accuracy: 0.63100000 time: 8.20619583s
Loading data from file ./cifar2/epoch53.npz
epoch  54 lr: 0.00100000  loss: 0.86144945  train accuracy: 0.69466000  test accuracy: 0.63380000 time: 8.17024136s
Loading data from file ./cifar2/epoch54.npz
epoch  55 lr: 0.00100000  loss: 0.85390811  train accuracy: 0.69958000  test accuracy: 0.63420000 time: 8.16201878s
Loading data from file ./cifar2/epoch55.npz
epoch  56 lr: 0.00100000  loss: 0.84586662  train accuracy: 0.70214000  test accuracy: 0.63690000 time: 8.17579746s
Loading data from file ./cifar2/epoch56.npz
epoch  57 lr: 0.00100000  loss: 0.84107336  train accuracy: 0.70396000  test accuracy: 0.63810000 time: 8.17300892s
Loading data from file ./cifar2/epoch57.npz
epoch  58 lr: 0.00100000  loss: 0.83712363  train accuracy: 0.70496000  test accuracy: 0.63640000 time: 8.17277718s
Loading data from file ./cifar2/epoch58.npz
epoch  59 lr: 0.00100000  loss: 0.82937527  train accuracy: 0.70830000  test accuracy: 0.63780000 time: 8.18279362s
Loading data from file ./cifar2/epoch59.npz
epoch  60 lr: 0.00100000  loss: 0.82976608  train accuracy: 0.70712000  test accuracy: 0.64240000 time: 8.18981647s
Loading data from file ./cifar2/epoch60.npz
epoch  61 lr: 0.00100000  loss: 0.81845075  train accuracy: 0.71038000  test accuracy: 0.63920000 time: 8.16982174s
Loading data from file ./cifar2/epoch61.npz
epoch  62 lr: 0.00100000  loss: 0.81849239  train accuracy: 0.71340000  test accuracy: 0.63830000 time: 8.17949104s
Loading data from file ./cifar2/epoch62.npz
epoch  63 lr: 0.00100000  loss: 0.80987730  train accuracy: 0.71360000  test accuracy: 0.64170000 time: 8.20404911s
Loading data from file ./cifar2/epoch63.npz
epoch  64 lr: 0.00100000  loss: 0.81359644  train accuracy: 0.71528000  test accuracy: 0.63890000 time: 8.17332554s
Loading data from file ./cifar2/epoch64.npz
epoch  65 lr: 0.00100000  loss: 0.80517699  train accuracy: 0.71554000  test accuracy: 0.63980000 time: 8.16863060s
Loading data from file ./cifar2/epoch65.npz
epoch  66 lr: 0.00100000  loss: 0.80355859  train accuracy: 0.71784000  test accuracy: 0.64170000 time: 8.16604042s
Loading data from file ./cifar2/epoch66.npz
epoch  67 lr: 0.00100000  loss: 0.80226488  train accuracy: 0.71962000  test accuracy: 0.64040000 time: 8.17292976s
Loading data from file ./cifar2/epoch67.npz
epoch  68 lr: 0.00100000  loss: 0.79981946  train accuracy: 0.71606000  test accuracy: 0.64070000 time: 8.16743755s
Loading data from file ./cifar2/epoch68.npz
epoch  69 lr: 0.00100000  loss: 0.79288048  train accuracy: 0.72144000  test accuracy: 0.64080000 time: 8.16992378s
Loading data from file ./cifar2/epoch69.npz
epoch  70 lr: 0.00100000  loss: 0.78953297  train accuracy: 0.72242000  test accuracy: 0.63900000 time: 8.16925049s
Loading data from file ./cifar2/epoch70.npz
epoch  71 lr: 0.00100000  loss: 0.79010774  train accuracy: 0.72204000  test accuracy: 0.64090000 time: 8.17843342s
Loading data from file ./cifar2/epoch71.npz
epoch  72 lr: 0.00100000  loss: 0.77995953  train accuracy: 0.72516000  test accuracy: 0.64210000 time: 8.17868137s
Loading data from file ./cifar2/epoch72.npz
epoch  73 lr: 0.00100000  loss: 0.78285045  train accuracy: 0.72620000  test accuracy: 0.64410000 time: 8.16758060s
Loading data from file ./cifar2/epoch73.npz
epoch  74 lr: 0.00100000  loss: 0.78750548  train accuracy: 0.72386000  test accuracy: 0.64020000 time: 8.16494274s
Loading data from file ./cifar2/epoch74.npz
epoch  75 lr: 0.00100000  loss: 0.77626517  train accuracy: 0.72820000  test accuracy: 0.64080000 time: 8.17547798s
Loading data from file ./cifar2/epoch75.npz
epoch  76 lr: 0.00010000  loss: 0.82172756  train accuracy: 0.70748000  test accuracy: 0.64210000 time: 8.17814827s
Loading data from file ./cifar2/epoch76.npz
epoch  77 lr: 0.00010000  loss: 0.81782433  train accuracy: 0.71024000  test accuracy: 0.64210000 time: 8.15233803s
Loading data from file ./cifar2/epoch77.npz
epoch  78 lr: 0.00010000  loss: 0.81898482  train accuracy: 0.71002000  test accuracy: 0.64210000 time: 8.22123051s
Loading data from file ./cifar2/epoch78.npz
epoch  79 lr: 0.00010000  loss: 0.81728667  train accuracy: 0.71008000  test accuracy: 0.64210000 time: 8.17180920s
Loading data from file ./cifar2/epoch79.npz
epoch  80 lr: 0.00010000  loss: 0.81743291  train accuracy: 0.71070000  test accuracy: 0.64250000 time: 8.17517185s
Loading data from file ./cifar2/epoch80.npz
epoch  81 lr: 0.00010000  loss: 0.81926674  train accuracy: 0.71196000  test accuracy: 0.64360000 time: 8.19967842s
Loading data from file ./cifar2/epoch81.npz
epoch  82 lr: 0.00010000  loss: 0.81689989  train accuracy: 0.71038000  test accuracy: 0.64390000 time: 8.18936825s
Loading data from file ./cifar2/epoch82.npz
epoch  83 lr: 0.00010000  loss: 0.81961810  train accuracy: 0.70964000  test accuracy: 0.64450000 time: 8.17032337s
Loading data from file ./cifar2/epoch83.npz
epoch  84 lr: 0.00010000  loss: 0.81791947  train accuracy: 0.71178000  test accuracy: 0.64490000 time: 8.23103905s
Loading data from file ./cifar2/epoch84.npz
epoch  85 lr: 0.00010000  loss: 0.81543670  train accuracy: 0.71098000  test accuracy: 0.64710000 time: 8.18459511s
Loading data from file ./cifar2/epoch85.npz
epoch  86 lr: 0.00010000  loss: 0.81543660  train accuracy: 0.71100000  test accuracy: 0.64550000 time: 8.17573547s
Loading data from file ./cifar2/epoch86.npz
epoch  87 lr: 0.00010000  loss: 0.81824868  train accuracy: 0.71088000  test accuracy: 0.64530000 time: 8.17115021s
Loading data from file ./cifar2/epoch87.npz
epoch  88 lr: 0.00010000  loss: 0.81189444  train accuracy: 0.71174000  test accuracy: 0.64520000 time: 8.17556381s
Loading data from file ./cifar2/epoch88.npz
epoch  89 lr: 0.00010000  loss: 0.81131458  train accuracy: 0.71116000  test accuracy: 0.64550000 time: 8.21609306s
Loading data from file ./cifar2/epoch89.npz
epoch  90 lr: 0.00010000  loss: 0.80872991  train accuracy: 0.71472000  test accuracy: 0.64530000 time: 8.17313671s
Loading data from file ./cifar2/epoch90.npz
epoch  91 lr: 0.00010000  loss: 0.81492701  train accuracy: 0.71396000  test accuracy: 0.64520000 time: 8.17979240s
Loading data from file ./cifar2/epoch91.npz
epoch  92 lr: 0.00010000  loss: 0.80828797  train accuracy: 0.71422000  test accuracy: 0.64650000 time: 8.21807766s
Loading data from file ./cifar2/epoch92.npz
epoch  93 lr: 0.00010000  loss: 0.81086143  train accuracy: 0.71200000  test accuracy: 0.64540000 time: 8.21543407s
Loading data from file ./cifar2/epoch93.npz
epoch  94 lr: 0.00010000  loss: 0.81129853  train accuracy: 0.71170000  test accuracy: 0.64520000 time: 8.17661953s
Loading data from file ./cifar2/epoch94.npz
epoch  95 lr: 0.00010000  loss: 0.80628731  train accuracy: 0.71328000  test accuracy: 0.64610000 time: 8.16823578s
Loading data from file ./cifar2/epoch95.npz
epoch  96 lr: 0.00010000  loss: 0.81033319  train accuracy: 0.71334000  test accuracy: 0.64700000 time: 8.16111565s
Loading data from file ./cifar2/epoch96.npz
epoch  97 lr: 0.00010000  loss: 0.80765690  train accuracy: 0.71422000  test accuracy: 0.64650000 time: 8.17469120s
Loading data from file ./cifar2/epoch97.npz
epoch  98 lr: 0.00010000  loss: 0.80954939  train accuracy: 0.71312000  test accuracy: 0.64760000 time: 8.17833996s
Loading data from file ./cifar2/epoch98.npz
epoch  99 lr: 0.00010000  loss: 0.81151606  train accuracy: 0.71268000  test accuracy: 0.64620000 time: 8.16102219s
Loading data from file ./cifar2/epoch99.npz
epoch 100 lr: 0.00010000  loss: 0.81242087  train accuracy: 0.71210000  test accuracy: 0.64580000 time: 8.18653965s
Accuracy of the network on the 10000 test examples: 64.58%
Total training time for the 100 epochs: 818.23267729s
